# OttieVerse — Execution Phases

> Source of truth for all Epic decomposition. Each phase is a shippable increment with strict dependency ordering.
>
> **Deadline:** February 14, 2026 | **Platform:** iOS (Capacitor 8) | **Architecture:** Static Export SPA

---

## Phase Table

| Phase | Title                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Definition of Done                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ----- | ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| PH-01 | Foundation & Tooling         | Configure global CSS resets (tap highlight, overscroll, selection, body lock), load fonts (Inter, Caveat, Playfair Display), define the shared type system (`src/types/index.ts` — Scene union, quiz question types, word search types, haptic event map), implement library utilities (`src/lib/haptics.ts`, `src/lib/constants.ts`, `src/lib/sms.ts`), and update `layout.tsx` with app metadata and safe area viewport config.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | <ul><li>`pnpm build` produces clean static export with zero errors</li><li>`npx biome check .` passes with zero diagnostics</li><li>`globals.css` contains browser-reset rules: `-webkit-tap-highlight-color`, `-webkit-touch-callout`, `overscroll-behavior`, `user-select`, body `position: fixed`, and `dvh` viewport height</li><li>All three fonts load via `next/font` with correct weights (Inter 400/500/700, Caveat 400, Playfair Display 400/700)</li><li>`types/index.ts` exports `Scene` discriminated union, `SCENE_ORDER` constant, `QuizQuestion` type, and `WordSearchConfig` type with zero `any`</li><li>`haptics.ts` exposes `light`, `medium`, `heavy`, `success`, `error`, `vibrate`, `pattern` methods gated behind `Capacitor.isNativePlatform()`</li></ul>    |
| PH-02 | Scene Engine & Shared UI     | Build the scene orchestrator (`experience.tsx` — `useReducer`-based state machine managing `currentScene` transitions), the `AnimatePresence` wrapper component (`scene-transition.tsx` with `mode="wait"`), the otter sprite animator (`otter-sprite.tsx` — frame cycling at configurable FPS), the floating hearts particle layer (`floating-hearts.tsx` — canvas overlay, `pointer-events: none`), the confetti system (`confetti.tsx` — canvas-based, 200+ particles, 3s duration), and mount `<Experience />` in `page.tsx`.                                                                                                                                                                                                                                                                                                                                                                                                                 | <ul><li>`experience.tsx` renders correct scene component for each `Scene` value and advances via `onComplete` callback</li><li>Scene transitions animate with `AnimatePresence mode="wait"` — outgoing scene exits before incoming enters</li><li>`otter-sprite.tsx` cycles through provided image paths at specified FPS with spring scale-in animation</li><li>`floating-hearts.tsx` renders 0/0/0/3-5/8-10/20+ hearts matching DESIGN_DOC Section 6 scene density</li><li>`confetti.tsx` fires 200+ particles on trigger with 3s duration and auto-cleanup</li><li>App renders Welcome scene on load with no console errors</li></ul>                                                                                                                                              |
| PH-03 | Welcome & Quiz Scenes        | Implement Scene 0 (Welcome): full-screen teal→violet gradient, otter wave animation cycling 3 frames at 4fps, title "Hi Carolina" with 0.3s fade-in, subtitle "Tap anywhere to begin" with 1.5s delayed fade-in and pulse, tap-anywhere advances with `ImpactStyle.Light`. Implement Scene 1 (Quiz): card-based 5-question engine with shuffled options, progress dots, otter reactions (thinking/celebrate/confused), correct answer green glow + `NotificationStyle.Success` + 1.2s auto-advance, wrong answer shake + red + "Babe... really?" + `NotificationStyle.Error` + retry, Q2 dual-correct logic ("January 25" or "January 26").                                                                                                                                                                                                                                                                                                       | <ul><li>Welcome scene renders gradient, animated otter, title, and subtitle with correct timing delays</li><li>Tap anywhere on Welcome fires `ImpactStyle.Light` haptic and transitions to Quiz</li><li>Quiz renders 5 questions sequentially with 4 shuffled option cards per question</li><li>Correct answer: card glows green, otter swaps to celebrate, haptic fires, auto-advances after 1.2s</li><li>Wrong answer: card shakes (x offset pattern), turns red, shows "Babe... really?", otter swaps to confused, allows immediate retry</li><li>Q2 accepts both "January 25" and "January 26" as correct</li><li>Progress dots fill accurately (5 dots, sequential)</li><li>All 5 correct answers trigger transition to next scene</li></ul>                                     |
| PH-04 | Word Search Scene            | Implement Scene 2 (Word Search): 10×10 letter grid generator (`generator.ts` — places 7 words: DINN, OTTIE, FOREVER, TORONTO, CRIMINAL, LOVE, BEBE in specified directions, fills 14 remaining cells with "BE MY VALENTINE" letters, 47 cells with weighted random filler), drag selection hook (`use-drag-select.ts` — pointer event tracking, direction lock after 2nd cell, colored highlight line), grid renderer (`grid.tsx` — cell layout, selection overlay, found-word persistence with unique warm-palette colors), word list display with cross-off, otter reactions (peeking→excited), and hidden message reveal sequence (1s pause → sequential letter pulse → "BE MY VALENTINE" highlight → 3-pulse haptic pattern → 3s hold → auto-advance).                                                                                                                                                                                        | <ul><li>Grid generates deterministically with all 7 words placed in correct directions and remaining letters encoding "BE MY VALENTINE"</li><li>Drag selection locks direction after 2nd cell (horizontal, vertical, or diagonal only)</li><li>Valid word selection: word stays highlighted with unique color, haptic `ImpactStyle.Medium` fires, otter swaps to excited, word crosses off list</li><li>Invalid selection: highlight fades, no penalty, no haptic</li><li>After all 7 words found: 1s pause → remaining letters pulse sequentially → "BE MY VALENTINE" reveals → 3× `ImpactStyle.Light` at 100ms intervals → auto-advance after 3s</li><li>Grid renders without layout shift or lag on iOS Safari WebView</li></ul>                                                   |
| PH-05 | Poetry, Letter & Ask Scenes  | Implement Scene 3 (Poetry Canvas): amber→rose gradient, serif prompt, auto-growing textarea styled as canvas (Caveat font, 22px, no visible border, 16px minimum for iOS zoom prevention), 1-char minimum to enable submit, static response on submit with `ImpactStyle.Light`. Implement Scene 4 (Letter): burgundy→midnight gradient, Playfair Display serif body at 1.8 line-height, max-width 600px centered, paragraphs fade in with 0.5s stagger, scroll/tap progressive reveal, no haptics. Implement Scene 5 (The Ask): rose-gold gradient, otter-heart centered, "Will you be my Valentine?" in Playfair 700/32px, "No" button degradation sequence (6 stages: shrink 20%→40%→60%→80%→pointer-flee→disappear, with crying otter, `ImpactStyle.Heavy` + screen shake each press), "Yes" grows 5% and glows brighter per "No" press, "Yes" triggers confetti + party otter + `NotificationStyle.Success` + `vibrate()` + SMS CTA after 2s. | <ul><li>Poetry textarea renders in Caveat at 22px, auto-grows, has no visible border, and does not trigger iOS zoom</li><li>Submit shows static response text, fires `ImpactStyle.Light`, and reveals "Continue" after 2s</li><li>Letter paragraphs fade in sequentially with 0.5s stagger using spring physics</li><li>"Continue" appears only after all letter text is visible</li><li>"No" button executes all 6 degradation stages with correct shrink percentages, otter swaps to crying at stage 2, `ImpactStyle.Heavy` fires each press</li><li>"Yes" button grows 5% per "No" press and triggers full celebration sequence (confetti + party otter + haptic burst + SMS deep link CTA)</li><li>SMS CTA opens native Messages app with pre-filled recipient and body</li></ul> |
| PH-06 | Mobile Polish & Native Build | Finalize Capacitor iOS integration: run `npx cap sync`, configure app icon (1024×1024 source) and splash screen, verify safe area insets render correctly on iPhone 15/16 Pro models, audit every tappable element for 44×44pt minimum touch target and haptic feedback wiring, strip all remaining browser artifacts (rubber-banding, text selection handles, input field chrome, focus rings on non-keyboard interaction), verify `dvh` viewport units on all scene containers, test full scene progression on physical device or Simulator, optimize otter PNGs to < 200kb each.                                                                                                                                                                                                                                                                                                                                                               | <ul><li>`npx cap sync` completes without errors and `ios/` directory contains current web assets</li><li>App icon renders correctly at all iOS sizes (Settings, Home Screen, Spotlight)</li><li>Splash screen displays and transitions cleanly on cold launch</li><li>Every interactive element meets 44×44pt minimum and fires appropriate haptic on tap</li><li>Zero browser artifacts visible: no tap highlights, no callout menus, no text selection handles, no rubber-band overscroll on scene containers</li><li>Full 6-scene progression completes on iOS Simulator without crashes, layout breaks, or unrecoverable states</li><li>Total image payload < 3MB, each otter PNG < 200kb</li></ul>                                                                               |
| PH-07 | Final QA & Ship              | Run complete quality gate: `pnpm build` zero errors, `npx biome check .` zero diagnostics, TypeScript strict compilation zero errors, `./tools/protocol-zero.sh` zero violations. Perform 60fps animation audit on every scene transition and interaction (no dropped frames on spring animations, confetti, or drag selection). Verify bundle size < 150kb gzipped (excluding images). Execute full end-to-end walkthrough on physical iPhone: Welcome → Quiz (all 5 correct) → Word Search (all 7 words + hidden message) → Poetry (submit text) → Letter (read through) → The Ask (test "No" degradation + "Yes" celebration + SMS launch). Archive Xcode build for distribution.                                                                                                                                                                                                                                                              | <ul><li>`pnpm build` + `npx biome check .` + `tsc --noEmit` all pass with zero errors/diagnostics</li><li>`./tools/protocol-zero.sh` passes — zero AI-attribution violations in codebase</li><li>Bundle size (gzipped, excluding images) < 150kb</li><li>All scene transitions and interactions maintain 60fps on target device (no dropped frames in Performance Inspector)</li><li>Complete end-to-end walkthrough succeeds on physical iPhone with correct haptics at every touchpoint</li><li>Xcode archive builds successfully and installs on target device</li></ul>                                                                                                                                                                                                           |

---

## Dependency Graph

```
PH-01 ──→ PH-02 ──→ PH-03 ──→ PH-04 ──→ PH-05 ──→ PH-06 ──→ PH-07
                                                        ↑
                                               Dinesh provides:
                                               • Scene 4 letter text
                                               • SMS pre-filled message
                                               • Phone number for SMS link
```

**Strict ordering.** Each phase depends on all prior phases. PH-05 has an external dependency on Dinesh providing letter content and SMS configuration before Scene 4 and Scene 5 can be finalized.

---

## External Blockers

| Item                                    | Owner  | Required By | Status                                  |
| --------------------------------------- | ------ | ----------- | --------------------------------------- |
| Scene 4 letter content                  | Dinesh | PH-05       | Pending                                 |
| SMS pre-filled message text             | Dinesh | PH-05       | Pending                                 |
| Dinesh's phone number for SMS deep link | Dinesh | PH-05       | Pending                                 |
| Otter asset optimization (< 200kb each) | Dinesh | PH-06       | Current total ~28MB — needs compression |

---

## Phase-to-File Mapping

| Phase | Primary Files                                                                                                                                                                                                  |
| ----- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| PH-01 | `src/types/index.ts`, `src/lib/haptics.ts`, `src/lib/constants.ts`, `src/lib/sms.ts`, `src/app/globals.css`, `src/app/layout.tsx`                                                                              |
| PH-02 | `src/components/experience.tsx`, `src/components/ui/scene-transition.tsx`, `src/components/ui/otter-sprite.tsx`, `src/components/ui/floating-hearts.tsx`, `src/components/ui/confetti.tsx`, `src/app/page.tsx` |
| PH-03 | `src/components/scenes/welcome.tsx`, `src/components/scenes/quiz.tsx`                                                                                                                                          |
| PH-04 | `src/components/scenes/word-search.tsx`, `src/components/word-search/grid.tsx`, `src/components/word-search/use-drag-select.ts`, `src/components/word-search/generator.ts`                                     |
| PH-05 | `src/components/scenes/poetry-canvas.tsx`, `src/components/scenes/letter.tsx`, `src/components/scenes/the-ask.tsx`                                                                                             |
| PH-06 | `capacitor.config.ts`, `ios/` (native project), otter asset files in `public/otters/`                                                                                                                          |
| PH-07 | No new files — validation, audit, and archive only                                                                                                                                                             |
